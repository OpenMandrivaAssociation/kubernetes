From 776e6afbb9177ab9760c02ab657337d1e765a697 Mon Sep 17 00:00:00 2001
From: Jan Chaloupka <jchaloup@redhat.com>
Date: Thu, 24 Sep 2015 15:56:58 +0200
Subject: [PATCH] append missing flags to cobra flags

---
 pkg/cmd/server/start/kubernetes/apiserver.go   | 4 ++--
 pkg/cmd/server/start/kubernetes/controllers.go | 4 ++--
 pkg/cmd/server/start/kubernetes/kubelet.go     | 4 ++--
 pkg/cmd/server/start/kubernetes/proxy.go       | 4 ++--
 pkg/cmd/server/start/kubernetes/scheduler.go   | 4 ++--
 5 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/pkg/cmd/server/start/kubernetes/apiserver.go b/pkg/cmd/server/start/kubernetes/apiserver.go
index 21a38d5..71daaf8 100644
--- a/pkg/cmd/server/start/kubernetes/apiserver.go
+++ b/pkg/cmd/server/start/kubernetes/apiserver.go
@@ -1,6 +1,7 @@
 package kubernetes
 
 import (
+	"flag"
 	"fmt"
 	"io"
 	"os"
@@ -40,8 +41,7 @@ func NewAPIServerCommand(name, fullName string, out io.Writer) *cobra.Command {
 	cmd.SetOutput(out)
 
 	flags := cmd.Flags()
-	//TODO: uncomment after picking up a newer cobra
-	//pflag.AddFlagSetToPFlagSet(flag, flags)
+	util.AddFlagSetToPFlagSet(flag.CommandLine, flags)
 	s.AddFlags(flags)
 
 	return cmd
diff --git a/pkg/cmd/server/start/kubernetes/controllers.go b/pkg/cmd/server/start/kubernetes/controllers.go
index c92567d..ff9b3cf 100644
--- a/pkg/cmd/server/start/kubernetes/controllers.go
+++ b/pkg/cmd/server/start/kubernetes/controllers.go
@@ -1,6 +1,7 @@
 package kubernetes
 
 import (
+	"flag"
 	"fmt"
 	"io"
 	"os"
@@ -40,8 +41,7 @@ func NewControllersCommand(name, fullName string, out io.Writer) *cobra.Command
 	cmd.SetOutput(out)
 
 	flags := cmd.Flags()
-	//TODO: uncomment after picking up a newer cobra
-	//pflag.AddFlagSetToPFlagSet(flag, flags)
+	util.AddFlagSetToPFlagSet(flag.CommandLine, flags)
 	s.AddFlags(flags)
 
 	return cmd
diff --git a/pkg/cmd/server/start/kubernetes/kubelet.go b/pkg/cmd/server/start/kubernetes/kubelet.go
index 03a7227..6df47bb 100644
--- a/pkg/cmd/server/start/kubernetes/kubelet.go
+++ b/pkg/cmd/server/start/kubernetes/kubelet.go
@@ -1,6 +1,7 @@
 package kubernetes
 
 import (
+	"flag"
 	"fmt"
 	"io"
 	"os"
@@ -39,8 +40,7 @@ func NewKubeletCommand(name, fullName string, out io.Writer) *cobra.Command {
 	cmd.SetOutput(out)
 
 	flags := cmd.Flags()
-	//TODO: uncomment after picking up a newer cobra
-	//pflag.AddFlagSetToPFlagSet(flag, flags)
+	util.AddFlagSetToPFlagSet(flag.CommandLine, flags)
 	s.AddFlags(flags)
 
 	return cmd
diff --git a/pkg/cmd/server/start/kubernetes/proxy.go b/pkg/cmd/server/start/kubernetes/proxy.go
index 9893382..923a455 100644
--- a/pkg/cmd/server/start/kubernetes/proxy.go
+++ b/pkg/cmd/server/start/kubernetes/proxy.go
@@ -1,6 +1,7 @@
 package kubernetes
 
 import (
+	"flag"
 	"fmt"
 	"io"
 	"os"
@@ -40,8 +41,7 @@ func NewProxyCommand(name, fullName string, out io.Writer) *cobra.Command {
 	cmd.SetOutput(out)
 
 	flags := cmd.Flags()
-	//TODO: uncomment after picking up a newer cobra
-	//pflag.AddFlagSetToPFlagSet(flag, flags)
+	util.AddFlagSetToPFlagSet(flag.CommandLine, flags)
 	s.AddFlags(flags)
 
 	return cmd
diff --git a/pkg/cmd/server/start/kubernetes/scheduler.go b/pkg/cmd/server/start/kubernetes/scheduler.go
index 0c23e48..f33735b 100644
--- a/pkg/cmd/server/start/kubernetes/scheduler.go
+++ b/pkg/cmd/server/start/kubernetes/scheduler.go
@@ -1,6 +1,7 @@
 package kubernetes
 
 import (
+	"flag"
 	"fmt"
 	"io"
 	"os"
@@ -40,8 +41,7 @@ func NewSchedulerCommand(name, fullName string, out io.Writer) *cobra.Command {
 	cmd.SetOutput(out)
 
 	flags := cmd.Flags()
-	//TODO: uncomment after picking up a newer cobra
-	//pflag.AddFlagSetToPFlagSet(flag, flags)
+	util.AddFlagSetToPFlagSet(flag.CommandLine, flags)
 	s.AddFlags(flags)
 
 	return cmd
-- 
1.9.3

